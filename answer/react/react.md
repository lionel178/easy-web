# react 面试题

## 目录

- [1. React 中 setState 是同步的还是异步的](#1)
- [2. React 组件通信如何实现](#2)

## 题解

#### <a href="#1" id="1">1. React 中 setState 是同步的还是异步的</a>

有时表现出同步，有时表现出异步

1. setState 只在 React 自身的合成事件和钩子函数中是异步的，在原生事件和 setTimeout 中都是同步的。

2. setState 的异步并不是说内部由异步代码实现，其实本身执行的过程和代码都是同步的，只是合成事件和钩子函数的调用顺序在更新之前，导致在合成事件和钩子函数中没法立马拿到更新后的值，形成了所谓的异步，当然可以通过第二个参数 `setState(partialState, callback)` 中的 callback 拿到更新后的结果。
3. setState 的批量更新优化也是建立在异步（合成事件、钩子函数）之上的，在原生事件和 setTimeout 中不会批量更新，在异步中如果对同一个值进行多次 setState， setState 的批量更新策略会对其进行覆盖，取最后一次的执行，如果是同时 setState 多个不同的值，在更新时会对其进行合并批量更新。

<br/>
<br/>

#### <a href="#2" id="2">2. React 组件通信如何实现</a>

React 组件通信方式：

1. 父 -> 子：父组件可以向子组件通过传 props 的方式，向子组件进行通讯

2. 子 -> 父：props + 回调，父组件向子组件传递 props 进行通讯，此 props 为作用域为父组件自身的函数，子组件调用该函数，将子组件想要传递的信息，作为参数，传递到父组件的作用域中

3. 兄弟组件通信：找到这两个兄弟节点共同的父节点，结合上面两种方式由父节点转发信息进行通信

4. 跨层级通信： Context 设计目的是为了共享那些对于一个组件树而言是全局的数据，对于跨越多层的全局数据通过 Context 通信再合适不过

5. 发布订阅模式：我们可以通过引入 event 模块进行通信

6. 全局状态管理工具：借助 Redux 或者 Mobx 等全局状态管理工具进行通信，这种工具会维护一个全局状态中心 Store，并根据不同的事件产生新的状态。
