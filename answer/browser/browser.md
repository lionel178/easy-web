# 浏览器 面试题

## 目录

- [1. 介绍一下 V8 垃圾回收机制](#1)
- [2. 介绍一下 浏览器缓存](#2)
- [3. 几种前端存储以及它们之间的区别](#3)

## 题解

#### <a href="#1" id="1">1. 介绍一下 V8 垃圾回收机制</a>

垃圾回收：将内存中不再使用的数据进行清理，释放出内存空间。V8 将内存分为**新生代空间** 和 **老生代空间**。

- **新生代空间**：用于存活较短的对象
  - 又分为两个空间：from 空间 与 to 空间
  - Scavenge GC 算法：当 from 空间被占满时，启动 GC 算法
    - 存活的对象从 from 空间 转移到 to 空间
    - 清空 from 空间
    - from 空间与 to 空间 互换
    - 完成一次新生代 GC
- **老生代空间**：用于存活时间较长的对象
  - 从 新生代空间 转移到 老生代空间的条件
    - 经历过一次以上 Scavenge GC 的对象
    - 当 to 空间 体积超过 25%
  - **标记清除算法**：标记存活的对象，未被标记的则被释放
    - 增量标记：小模块标记，在代码执行间隙，GC 会影响性能
    - 并发标记：不阻塞 js 执行
  - **压缩算法**：将内存中清除后导致的碎片化对象往内存堆的一段移动，解决 **内存的碎片化**



<br>
<br>

#### <a href="#2" id="2">2. 介绍一下 浏览器缓存</a>

浏览器缓存分为强缓存和协商缓存。当客户端请求某个资源时，获取缓存的流程如下：

- 先根据这个资源的一些 `http header` 判断它是否命中强缓存，如果命中，则直接从本地获取缓存资源，不会发请求到服务器；
- 当强缓存没有命中时，客户端会发送请求到服务器，服务器通过另一些 `request header` 验证这个资源是否命中协商缓存，称为 `http` 再验证，如果命中，服务器将请求返回，但不返回资源，而是告诉客户端直接从缓存中获取，客户端收到返回后就会从缓存中获取资源；
- 当协商缓存也没命中时，服务器就会将资源发送会客户端；

* 强缓存和协商缓存的共同之处在于，如果命中缓存，服务器都不会返回资源；
* 区别是，强缓存不会发送请求到服务器，而协商缓存会；
* 当 `ctrl + f5` 强制刷新网页时，直接从服务器加载，跳过强缓存和协商缓存
* 当 `f5` 刷新网页时，跳过强缓存，但是会检查协商缓存

##### 强缓存

- `Expires` （该字段是 `http1.0` 时的规范，值为一个绝对时间的 `GMT` 格式的时间字符串，代表缓存资源的过期时间）

- `Cache-Control:max-age` （该字段是 `http1.1` 的规范，强缓存利用其 `max-age` 值来判断缓存资源的最大生命周期，它的值单位为秒）

##### 协商缓存

- `Last-Modified` （值为资源最后更新时间，随服务器 `response` 返回）

- `If-Modified-Since`（通过比较两个时间来判断资源在两次请求期间是否有过修改，如果没有修改，则命中协商缓存）
- `ETag`（表示资源内容的唯一表示，随服务器 `response` 返回）
- `If-None-Match` （服务器通过比较请求头部的 `If-None-Match` 与当前资源的 `ETag` 是否一致来判断资源是否在两次请求之间有过修改，如果没有修改，则命中协商缓存）

<br>
<br>

#### <a href="#3" id="3">3. 几种前端存储以及它们之间的区别</a>

- cookies：HTML5 之前本地存储的主要方式，大小只有 4k，HTTP 请求头会自动带上 cokkie，兼容性好
- localStorage：HTML5 新特性，持久性存储，即页面关闭也不会被清除，以键值对的方式存储，大小为 5M
- sessionStorage：HTML5 新特性，操作及大小同 localStorage，和 localStorage 的区别在于 sessionStorage 在页面被关闭时即清除，且浏览器不同的 tab 之间的 sessionStorage 不互通
- IndexedDB：NoSQL 型数据库，类似 MongoDB，使用键值对进行存储，异步操作数据库，支持事务，存储空间可以在 250MB 以上，但是 IndexedDB 受同源策略限制
- Web SQL：是在浏览器上模拟的关系型数据库，开发者可以通过 SQL 语句来操作 Web SQL，是 HTML5 以外一套独立的规范，兼容性差